
@model MusicStoreEntity.Album
@{ 
    Layout = "~/Views/Shared/_NewLayout.cshtml";
    ViewBag.Title = "专辑明细";
}

 <h2>歌曲名称:@Model.Title</h2>


 <div class="row">
    <div class="col-md-6">
        <span class="cd"></span></br>
        <audio style="background: #fbf9ef;margin-top:20PX;" src="@Model.MusicUrl" controls="controls"></audio>
    </div>
    <div class="col-md-6">
        <p>
            <img alt="@Model.Title" src="@Model.AlbumArtUrl" />
        </p>
        <p>
            <em>
                分类：
            </em>
            @Model.Genre.Name
        </p>
        <p>
            <em>
                歌手：
            </em>
            @Model.Artist.Name
        </p>
        <p>
            <em>
                价格：
            </em>
            $@string.Format("{0:F}", Model.Price)
        </p>
        <p>
            <em>
                发行时间：
            </em>
            @Model.PublisherDate.ToString("yyyy年MM月dd日");
        </p>
        <button id="addcart" type="submit" class="btn btn-primary">添加到购物车</button>
        <div id="msg"></div>

    </div>
</div>

<script>
    $("#addcart").click(function () {
        //异步
        $("#msg").html("<img src='../../content/images/ProgressIcon.gif'>添加到购物车,请稍后...");
        $.ajax({
            type: 'post',
            async: true,
            url: '../../ShoppingCart/AddCart',
            data: {id:"@Model.ID"},
            dataType:'json',
            success:function(data){
                if (data == "nologin")
                {
                    location.href="@Url.Action("Login", "Account",new {returnUrl = Url.Action("Detai", "Store", new {id = Model.ID})})";
                }
                else
                {
                    $("#msg").html(data);//添加成功 动画取消
                    setTimeout(function(){
                        location.reload();//刷新区域
                    },1000);
                }
            }
        });
    });
</script>